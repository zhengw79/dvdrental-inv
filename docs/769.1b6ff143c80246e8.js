"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[769],{8769:(Ut,A,c)=>{c.r(A),c.d(A,{OrderModule:()=>Nt});var y=c(6895),h=c(6216),e=c(8256),K=c(7064);function $(t,r){1&t&&e._UZ(0,"router-outlet")}let k=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-order"]],decls:3,vars:0,consts:[["child",""]],template:function(o,n){1&o&&(e.TgZ(0,"app-main"),e.YNc(1,$,1,0,"ng-template",null,0,e.W1O),e.qZA())},dependencies:[h.lC,K.C]}),t})();var L=c(2340);let j=(()=>{class t{constructor(o){this.router=o;const n=localStorage.getItem("access_token");this.dataTableOption={responsive:!0,processing:!0,serverSide:!0,searching:!1,ajax:{url:`${L.N.apiUrl}graphql`,type:"POST",contentType:"application/json",headers:{authorization:`bearer ${n}`},statusCode:{401:()=>{this.router.navigate(["/auth/login"])}}}}}initCustomersDatatable(){const o=Object.assign({},this.dataTableOption);return o.ajax.data=n=>{const s={operationName:null,query:"query retrieveCustomerDatatablePagination($pageOption: DatatablePaginationInput!){\n          retrieveCustomerDatatablePagination(pageOption: $pageOption) {\n            data { customer_id store_id first_name last_name email create_date address_id address } totalCount } }",variables:{pageOption:{paginate:{page:n.start/n.length,limit:n.length},sort:[{field:n.columns[n.order[0].column].data,order:n.order[0].dir.toUpperCase()}],search:n.search.vale??""}}};return JSON.stringify(s)},o.ajax.dataSrc=n=>{const{data:i,errors:s}=n;if(!s||!s[0]||"Unauthorized"!==s[0].message){const{retrieveCustomerDatatablePagination:a}=i;return n.recordsTotal=a.totalCount,n.recordsFiltered=a.totalCount,a.data}this.router.navigate(["/auth/login"])},o}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(h.F0))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const B=["customer_tbl"],X=function(){return["/order/customer/create"]};let ee=(()=>{class t{constructor(o,n,i){this.datatableService=o,this.router=n,this.ngZone=i,this.$=window.jQuery}ngOnInit(){window.onSelectCustomer=this.onSelectCustomer.bind(this)}ngAfterViewInit(){const o=this.datatableService.initCustomersDatatable();o.columnDefs=[{target:0,data:"customer_id",title:"Id",render:n=>`<button type='button' class='btn btn-primary btn-sm' onClick="onSelectCustomer(${n})"><i class="fas fa-eye"></i></button>`},{target:1,data:"first_name",title:"Customer Name",render:(n,i,s)=>`${n} ${s.last_name}`},{target:2,data:"email",title:"Email"},{target:3,data:"address",title:"Address"},{target:4,data:"store_id",title:"Store Id"}],this.$(this.customer_tbl?.nativeElement).DataTable(o)}onSelectCustomer(o){this.ngZone.run(()=>this.router.navigate([`/order/customer/${o}`]))}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(j),e.Y36(h.F0),e.Y36(e.R0b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-customers"]],viewQuery:function(o,n){if(1&o&&e.Gf(B,5),2&o){let i;e.iGM(i=e.CRH())&&(n.customer_tbl=i.first)}},hostBindings:function(o,n){1&o&&e.NdJ("onSelectCustomer",function(s){return n.onSelectCustomer(s)},!1,e.Jf7)},decls:15,vars:2,consts:[[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],["type","button",1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-plus"],[1,"row"],["ckass","col-12 mb-4"],[1,"col-12","mb-4"],[1,"card","shadow"],[1,"card-header"],[1,"card-body"],[1,"datatable"],[1,"display"],["customer_tbl",""]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Customers "),e.TgZ(3,"a",2),e._UZ(4,"i",3),e.qZA()()(),e.TgZ(5,"div",4),e._UZ(6,"div",5),e.qZA(),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8),e._uU(10,"Customers"),e.qZA(),e.TgZ(11,"div",9)(12,"div",10),e._UZ(13,"table",11,12),e.qZA()()()()),2&o&&(e.xp6(3),e.Q6J("routerLink",e.DdM(1,X)))},dependencies:[h.yS]}),t})();var m=c(5861),l=c(433),N=c(9688),te=c(9646),U=c(8421),x=c(9751),O=c(5577),oe=c(1144),v=c(576),ne=c(3268);const re=["addListener","removeListener"],ie=["addEventListener","removeEventListener"],se=["on","off"];function T(t,r,o,n){if((0,v.m)(o)&&(n=o,o=void 0),n)return T(t,r,o).pipe((0,ne.Z)(n));const[i,s]=function ce(t){return(0,v.m)(t.addEventListener)&&(0,v.m)(t.removeEventListener)}(t)?ie.map(a=>u=>t[a](r,u,o)):function le(t){return(0,v.m)(t.addListener)&&(0,v.m)(t.removeListener)}(t)?re.map(D(t,r)):function ae(t){return(0,v.m)(t.on)&&(0,v.m)(t.off)}(t)?se.map(D(t,r)):[];if(!i&&(0,oe.z)(t))return(0,O.z)(a=>T(a,r,o))((0,U.Xf)(t));if(!i)throw new TypeError("Invalid event target");return new x.y(a=>{const u=(...d)=>a.next(1<d.length?d:d[0]);return i(u),()=>s(u)})}function D(t,r){return o=>n=>t[o](r,n)}var q=c(4004),E=c(8505),de=c(9300),ue=c(4408);const P=new(c(640).v)(ue.o),me=P;var pe=c(4482),M=c(5403);const J={leading:!0,trailing:!1};var ge=c(3532);function ye(t,r=P,o=J){const n=function _e(t=0,r,o=me){let n=-1;return null!=r&&((0,ge.K)(r)?o=r:n=r),new x.y(i=>{let s=function ve(t){return t instanceof Date&&!isNaN(t)}(t)?+t-o.now():t;s<0&&(s=0);let a=0;return o.schedule(function(){i.closed||(i.next(a++),0<=n?this.schedule(void 0,n):i.complete())},s)})}(t,r);return function he(t,r=J){return(0,pe.e)((o,n)=>{const{leading:i,trailing:s}=r;let a=!1,u=null,d=null,f=!1;const p=()=>{d?.unsubscribe(),d=null,s&&(S(),f&&n.complete())},_=()=>{d=null,f&&n.complete()},C=g=>d=(0,U.Xf)(t(g)).subscribe((0,M.x)(n,p,_)),S=()=>{if(a){a=!1;const g=u;u=null,n.next(g),!f&&C(g)}};o.subscribe((0,M.x)(n,g=>{a=!0,u=g,(!d||d.closed)&&(i?S():C(g))},()=>{f=!0,(!(s&&a&&d)||d.closed)&&n.complete()}))})}(()=>n,o)}function Ce(t,r,o,n){const i=window&&!!window.document&&window.document.documentElement;let s=i&&r?window:o;if(t&&(s=t&&i&&"string"==typeof t?function Se(t,r,o){return(o?window.document:r).querySelector(t)}(t,o.nativeElement,n):t,!s))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return s}function Z(t){return t&&!t.firstChange}const Ze={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},be={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class Ie{constructor(r=!0){this.vertical=r,this.propsMap=r?Ze:be}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function Ue(t){return["Window","global"].some(o=>Object.prototype.toString.call(t).includes(o))}function b(t,r){return t?r.document.documentElement:null}function Y(t,r){const o=function De({container:t,isWindow:r,axis:o}){const{offsetHeightKey:n,clientHeightKey:i}=H(o);return F(t,r,n,i)}(r);return r.isWindow?function xe(t,r,o){const{axis:n,container:i,isWindow:s}=o,{offsetHeightKey:a,clientHeightKey:u}=H(n),d=t+Q(b(s,i),n,s),f=F(r.nativeElement,s,a,u),p=function qe(t,r,o){const n=r.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[n]+Q(t,r,o)}(r.nativeElement,n,s)+f;return{height:t,scrolled:d,totalToScroll:p,isWindow:s}}(o,t,r):function Oe(t,r,o){const{axis:n,container:i}=o;return{height:t,scrolled:i[n.scrollTopKey()],totalToScroll:i[n.scrollHeightKey()],isWindow:!1}}(o,0,r)}function H(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function F(t,r,o,n){if(isNaN(t[o])){const i=b(r,t);return i?i[n]:0}return t[o]}function Q(t,r,o){const n=r.pageYOffsetKey(),i=r.scrollTopKey(),s=r.offsetTopKey();return isNaN(window.pageYOffset)?b(o,t)[i]:t.ownerDocument?t.ownerDocument.defaultView[n]:t[s]}function Ee(t,r={down:0,up:0},o){let n,i;if(t.totalToScroll<=0)return!1;const s=t.isWindow?t.scrolled:t.height+t.scrolled;return o?(n=(t.totalToScroll-s)/t.totalToScroll,i=(r?.down?r.down:0)/10):(n=t.scrolled/(t.scrolled+(t.totalToScroll-s)),i=(r?.up?r.up:0)/10),n<=i}class He{constructor({totalToScroll:r}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=r}updateScrollPosition(r){return this.lastScrollPosition=r}updateTotalToScroll(r){this.lastTotalToScroll!==r&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=r)}updateScroll(r,o){this.updateScrollPosition(r),this.updateTotalToScroll(o)}updateTriggeredFlag(r,o){o?this.triggered.down=r:this.triggered.up=r}isTriggeredScroll(r,o){return o?this.triggered.down===r:this.triggered.up===r}}function Fe(t){const{scrollContainer:r,scrollWindow:o,element:n,fromRoot:i}=t,s=function Ae({windowElement:t,axis:r}){return function Ne(t,r){const o=t.isWindow||r&&!r.nativeElement?r:r.nativeElement;return{...t,container:o}}({axis:r,isWindow:Ue(t)},t)}({axis:new Ie(!t.horizontal),windowElement:Ce(r,o,n,i)}),a=new He({totalToScroll:Y(n,s)}),d={up:t.upDistance,down:t.downDistance};return function Qe(t){let r=T(t.container,"scroll");return t.throttle&&(r=r.pipe(ye(t.throttle,void 0,{leading:!0,trailing:!0}))),r}({container:s.container,throttle:t.throttle}).pipe((0,O.z)(()=>(0,te.of)(Y(n,s))),(0,q.U)(f=>function Ve(t,r,o){const{scrollDown:n,fire:i}=function Me(t,r,o){const n=function Pe(t,r){return t<r.scrolled}(t,r);return{fire:Ee(r,o,n),scrollDown:n}}(t,r,o);return{scrollDown:n,fire:i,stats:r}}(a.lastScrollPosition,f,d)),(0,E.b)(({stats:f})=>a.updateScroll(f.scrolled,f.totalToScroll)),(0,de.h)(({fire:f,scrollDown:p,stats:{totalToScroll:_}})=>function we(t,r,o){return!!(t&&r||!o&&r)}(t.alwaysCallback,f,a.isTriggeredScroll(_,p))),(0,E.b)(({scrollDown:f,stats:{totalToScroll:p}})=>{a.updateTriggeredFlag(p,f)}),(0,q.U)(We))}function We(t){const{scrollDown:r,stats:{scrolled:o}}=t;return{type:r?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:o}}}let ze=(()=>{class t{constructor(o,n){this.element=o,this.zone=n,this.scrolled=new e.vpe,this.scrolledUp=new e.vpe,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:o,infiniteScrollDisabled:n,infiniteScrollDistance:i}){const s=Z(o),a=Z(n),u=Z(i),d=!a&&!this.infiniteScrollDisabled||a&&!n.currentValue||u;(s||a||u)&&(this.destroyScroller(),d&&this.setup())}setup(){(function Te(){return typeof window<"u"})()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=Fe({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(o=>this.handleOnScroll(o))})}handleOnScroll({type:o,payload:n}){const i="[NGX_ISE] DOWN"===o?this.scrolled:this.scrolledUp;(function Ge(t){return t.observed??t.observers.length>0})(i)&&this.zone.run(()=>i.emit(n))}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(e.SBq),e.Y36(e.R0b))},t.\u0275dir=e.lG2({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[e.TTD]}),t})(),Re=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({}),t})();const Ke=["address_list"];function $e(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",14)(1,"div",15)(2,"input",16),e.NdJ("change",function(i){e.CHM(o);const s=e.oxw(2);return e.KtG(s.selected(i))}),e.qZA()(),e.TgZ(3,"div",17)(4,"label",18),e._uU(5),e._UZ(6,"br")(7,"i",19),e._uU(8),e._UZ(9,"br")(10,"i",20),e._uU(11),e.qZA()()()}if(2&t){const o=r.$implicit;e.xp6(2),e.Q6J("value",o.address_id)("id",o.address_id),e.xp6(2),e.Q6J("htmlFor",o.address_id),e.xp6(1),e.xDo("",o.address,", ",o.address2,", ",o.district,", ",o.city,", ",o.country,""),e.xp6(3),e.hij(": ",o.postal_code," "),e.xp6(3),e.hij(": ",o.phone,"")}}function ke(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"div",11),e.NdJ("scrolled",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.onScroll())}),e.TgZ(1,"form",12),e.YNc(2,$e,12,10,"div",13),e.qZA()()}if(2&t){const o=e.oxw();e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",50)("scrollWindow",!1),e.xp6(1),e.Q6J("formGroup",o.fg_address),e.xp6(1),e.Q6J("ngForOf",o.addresses)}}let Le=(()=>{class t{constructor(o){this.addressService=o,this.addresses=[],this.fg_search=new l.cw({search_txt:new l.NI("")}),this.$=window.jQuery,this.fg_address=new l.cw({address_id:new l.NI})}ngOnInit(){}ngAfterViewInit(){return(0,m.Z)(function*(){})()}get search_txt(){return this.fg_search.get("search_txt")}onSubmit(){var o=this;return(0,m.Z)(function*(){o.addresses=[],o.search_after=0,yield o.fetchAddress()})()}onScroll(){var o=this;return(0,m.Z)(function*(){yield o.fetchAddress()})()}fetchAddress(){var o=this;return(0,m.Z)(function*(){const{data:n}=yield o.addressService.retrieveScrollAddressES({query:o.search_txt?.value,size:5,search_after:o.search_after??0});n&&(o.addresses=o.addresses.concat(n),o.search_after=n[n.length-1].address_id)})()}selected(o){console.log(this.fg_address.value)}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(N.D))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-customer-search-address"]],viewQuery:function(o,n){if(1&o&&e.Gf(Ke,5),2&o){let i;e.iGM(i=e.CRH())&&(n.address_list=i.first)}},decls:12,vars:2,consts:[[1,"card","shadow","mb-4"],[1,"card-header"],[1,"m-0","font-weight-bold","text-primary"],[1,"card-body"],[1,"form-inline","mr-auto","w-80","navbar-search",3,"formGroup","ngSubmit"],[1,"input-group","w-100"],["type","text","placeholder","Search for address","aria-label","Search","aria-describedby","search-address","name","search_txt","formControlName","search_txt",1,"form-control","bg-light","border-0","small"],[1,"input-group-append"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-search","fa-sm"],["class","search-results mt-2","infiniteScroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","scrolled",4,"ngIf"],["infiniteScroll","",1,"search-results","mt-2",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","scrolled"],[3,"formGroup"],["class","row my-2 py-2 border-bottom",4,"ngFor","ngForOf"],[1,"row","my-2","py-2","border-bottom"],[1,"col-2","center"],["type","radio","formControlName","address_id",1,"form-control","form-control-user",3,"value","id","change"],[1,"col-10","center"],[1,"form-span","mx-2",3,"htmlFor"],[1,"fas","fa-mail-bulk"],[1,"fas","fa-phone-volume"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h6",2),e._uU(3,"Search Address"),e.qZA()(),e.TgZ(4,"div",3)(5,"form",4),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(6,"div",5),e._UZ(7,"input",6),e.TgZ(8,"div",7)(9,"button",8),e._UZ(10,"i",9),e.qZA()()()(),e.YNc(11,ke,3,5,"div",10),e.qZA()()),2&o&&(e.xp6(5),e.Q6J("formGroup",n.fg_search),e.xp6(6),e.Q6J("ngIf",n.addresses.length))},dependencies:[y.sg,y.O5,l._Y,l.Fj,l._,l.JJ,l.JL,l.sg,l.u,ze],styles:[".input-group[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{font-size:.8rem;padding:19px}.search-results[_ngcontent-%COMP%]{height:25rem;overflow-y:auto;overflow-x:hidden;border:1px solid #d1d3e2;border-radius:5px}input[type=radio][_ngcontent-%COMP%]{font-size:.3rem}.center[_ngcontent-%COMP%]{display:flex;align-items:center}.center[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0;justify-content:start}"]}),t})();var V=c(2284),W=c(4854),z=c(4158),G=c(9808),je=c(5136);let Be=(()=>{class t extends je.b{retrieveCustomerEntityById(o){var n=this;return(0,m.Z)(function*(){const{data:i,errors:s}=yield(0,G.n)(n.apollo.query({query:z.Ps`query {
        retrieveCustomerEntityById(customer_id: ${o}) {
          customer_id store_id first_name last_name email create_date
          address { address_id address address2 district phone postal_code
            city { city { city_id city }
              country { country_id country }}}
          rentals { rental_id rental_date return_date }
          payments { payment_id payment_date paypal_request_id }
        }}`}));return n.redirectToLoginIfError(s),i.retrieveCustomerEntityById})()}updateCustomerInfo(o){var n=this;return(0,m.Z)(function*(){const{data:i,errors:s}=yield(0,G.n)(n.apollo.query({query:z.Ps`mutation updateCustomerInfo($payload: CustomerInfoInput!) {
        updateCustomerInfo(payload: $payload)
      }`,variables:{payload:o}}));return n.redirectToLoginIfError(s),i.updateCustomerInfo})()}}return t.\u0275fac=function(){let r;return function(n){return(r||(r=e.n5z(t)))(n||t)}}(),t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Xe=c(9103);const et=["customer_card_el"],tt=["phone_el"],ot=["postal_el"],nt=["country_el"],rt=["city_el"];function it(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please enter customer's first name. "),e.qZA())}function st(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter customer's last name."),e.qZA())}function lt(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,st,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.last_name.errors?null:o.last_name.errors.required)}}function at(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter customer's email."),e.qZA())}function ct(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter a valid customer's email."),e.qZA())}function dt(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,at,2,0,"div",10),e.YNc(2,ct,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.email.errors?null:o.email.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.email.errors?null:o.email.errors.email)}}function ut(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter the customer's address."),e.qZA())}function ft(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,ut,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.address.errors?null:o.address.errors.required)}}function mt(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please enter customer's district. "),e.qZA())}function pt(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,mt,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.district.errors?null:o.district.errors.required)}}function ht(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please enter customer's phone number. "),e.qZA())}function gt(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please enter a valid phone number. "),e.qZA())}function vt(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,ht,2,0,"div",10),e.YNc(2,gt,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.phone.errors?null:o.phone.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.phone.errors?null:o.phone.errors.valid_phone)}}function _t(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter postal code."),e.qZA())}function yt(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1,"Please enter a valid postal code."),e.qZA())}function Ct(t,r){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,_t,2,0,"div",10),e.YNc(2,yt,2,0,"div",10),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.postal_code.errors?null:o.postal_code.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.postal_code.errors?null:o.postal_code.errors.valid_postalcode)}}function St(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please choose a country. "),e.qZA())}function Tt(t,r){1&t&&(e.TgZ(0,"div",31),e._uU(1," Please choose a city. "),e.qZA())}let Zt=(()=>{class t{constructor(o,n,i,s){this.orderService=o,this.addressService=n,this._route=i,this.validatorService=s,this.countries=[],this.fg_customer=new l.cw({customer_id:new l.NI(""),address_id:new l.NI(""),first_name:new l.NI("",[l.kI.required]),last_name:new l.NI("",[l.kI.required]),email:new l.NI("",[l.kI.required,l.kI.email]),create_date:new l.NI({disabled:!0,value:""}),address:new l.NI("",[l.kI.required]),address2:new l.NI("",[l.kI.required]),district:new l.NI("",[l.kI.required]),phone:new l.NI("",[l.kI.required,s.phoneNumberValidator]),postal_code:new l.NI("",[l.kI.required,s.postalcodeValidator]),country_id:new l.NI("",[l.kI.required]),city_id:new l.NI({value:"",disabled:!0},l.kI.required)}),this.customer_id=parseInt(i.snapshot.paramMap.get("customer_id")),this.$=window.jQuery}ngOnInit(){}ngAfterViewInit(){var o=this;return(0,m.Z)(function*(){if(o.im_phone=(0,V.ZP)(o.phone_el?.nativeElement,{mask:"(000)000-00-00",lazy:!1,placeholderChar:"_",commit:(n,i)=>{const{unmaskedValue:s}=i;o.phone?.setValue(s)}}),o.im_postal=(0,V.ZP)(o.postal_el?.nativeElement,{mask:"a0a-0a0",lazy:!1,placeholderChar:"#",commit:(n,i)=>{const{unmaskedValue:s}=i;o.postal_code?.setValue(s)}}),yield o.initCountry(),o.customer_id){const n=yield o.orderService.retrieveCustomerEntityById(o.customer_id);o.prefillCustomerForm(n)}})()}prefillCustomerForm(o){const{first_name:n,last_name:i,email:s,create_date:a,address:{address_id:u,address:d,address2:f,district:p,phone:_,postal_code:C,city:{city:{city_id:S},country:{country_id:w}}}}=o;this._customer_id?.setValue(this.customer_id),this.address_id?.setValue(u),this.first_name?.setValue(n),this.last_name?.setValue(i),this.email?.setValue(s),this.create_date?.setValue(a),this.address?.setValue(d),this.address2?.setValue(f),this.district?.setValue(p?.toUpperCase()),this.phone?.setValue(_),this.im_phone.value=_,this.postal_code?.setValue(C),this.im_postal.value=C,this.country?.setValue(w),this.sel_country?.val(w).trigger("change"),this.city?.setValue(S),this.initCity(w),this.sel_city?.val(S).trigger("change")}initCountry(){var o=this;return(0,m.Z)(function*(){o.$(o.customer_card_el?.nativeElement).block({message:null,css:W.Q});const n=yield o.addressService.retrieveCountryEntities();o.$(o.customer_card_el?.nativeElement).unblock();const i=o.$(o.country_el?.nativeElement);i.hasClass("select2-hidden-accessible")&&(i.empty().trigger("change"),i.select2("destroy")),n&&(o.sel_country=i.select2({data:[{id:"",text:"Please select a country."},...n.map(s=>({id:s.country_id,text:s.country}))]}).on("select2:select",s=>{const{id:a}=s.params.data;o.country?.setValue(+a)}),o.countries=n),o.country?.valueChanges.subscribe(s=>{o.sel_country.val(s).trigger("change"),o.initCity(s)})})()}initCity(o){const n=this.$(this.city_el?.nativeElement);n.hasClass("select2-hidden-accessible")&&(n.empty().trigger("change"),n.select2("destroy"));const i=this.countries.find(s=>s.country_id===o);if(i){const{cities:s}=i;this.sel_city=n.select2({data:[{id:"",text:"Please select a city."},...s.map(a=>({id:a.city_id,text:a.city}))]}).on("select2:select",a=>{const{id:u}=a.params.data;this.city?.setValue(+u)}),this.city?.enable(),this.city?.valueChanges.subscribe(a=>{this.sel_city.val(a).trigger("change")})}else this.city?.disable()}get address_id(){return this.fg_customer.get("address_id")}get _customer_id(){return this.fg_customer.get("customer_id")}get first_name(){return this.fg_customer.get("first_name")}get last_name(){return this.fg_customer.get("last_name")}get email(){return this.fg_customer.get("email")}get create_date(){return this.fg_customer.get("create_date")}get address(){return this.fg_customer.get("address")}get address2(){return this.fg_customer.get("address2")}get district(){return this.fg_customer.get("district")}get phone(){return this.fg_customer.get("phone")}get postal_code(){return this.fg_customer.get("postal_code")}get country(){return this.fg_customer.get("country_id")}get city(){return this.fg_customer.get("city_id")}onSubmit(){var o=this;return(0,m.Z)(function*(){if(o.fg_customer.markAllAsTouched(),o.fg_customer.invalid)return;const{country_id:n,...i}=o.fg_customer.value;o.$(o.customer_card_el?.nativeElement).block({message:null,css:W.Q}),o.customer_id&&(yield o.orderService.updateCustomerInfo(i)),o.$(o.customer_card_el?.nativeElement).unblock()})()}onReset(){this.fg_customer.reset(),this.ngAfterViewInit()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(Be),e.Y36(N.D),e.Y36(h.gz),e.Y36(Xe.o))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-customer-info"]],viewQuery:function(o,n){if(1&o&&(e.Gf(et,5),e.Gf(tt,5),e.Gf(ot,5),e.Gf(nt,5),e.Gf(rt,5)),2&o){let i;e.iGM(i=e.CRH())&&(n.customer_card_el=i.first),e.iGM(i=e.CRH())&&(n.phone_el=i.first),e.iGM(i=e.CRH())&&(n.postal_el=i.first),e.iGM(i=e.CRH())&&(n.country_el=i.first),e.iGM(i=e.CRH())&&(n.city_el=i.first)}},decls:80,vars:10,consts:[[1,"card","shadow","mb-4"],[1,"card-header"],[1,"m-0","font-weight-bold","text-primary"],[1,"card-body"],["customer_card_el",""],[1,"user",3,"formGroup","ngSubmit"],[1,"form-group","row"],[1,"col-sm-6","mb-3","mb-sm-0"],[1,"form-span","mx-2"],["type","text","formControlName","first_name",1,"form-control","form-control-user"],["class","help-error",4,"ngIf"],["type","text","formControlName","last_name",1,"form-control","form-control-user"],[4,"ngIf"],["type","text","formControlName","email",1,"form-control","form-control-user"],["type","text","formControlName","create_date",1,"form-control","form-control-user"],[1,"col-sm-12","mb-3","mb-sm-0"],["type","text","formControlName","address",1,"form-control","form-control-user"],["type","text","formControlName","address2",1,"form-control","form-control-user"],["type","text","formControlName","district",1,"form-control","form-control-user"],["type","text","formControlName","phone",1,"form-control","form-control-user"],["phone_el",""],["type","text","formControlName","postal_code",1,"form-control","form-control-user"],["postal_el",""],["formControlName","country_id",1,"form-control","form-control-user","form-control-select"],["country_el",""],["formControlName","city_id",1,"form-control","form-control-user","form-control-select"],["city_el",""],[1,"form-group","row","mb-3"],[1,"col"],["type","submit",1,"btn","btn-primary","btn-user","btn-block"],["type","button",1,"btn","btn-secondary","btn-user","btn-block",3,"click"],[1,"help-error"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h6",2),e._uU(3,"Customer Info"),e.qZA()(),e.TgZ(4,"div",3,4)(6,"form",5),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(7,"div",6)(8,"div",7)(9,"label",8),e._uU(10,"First name*"),e.qZA(),e._UZ(11,"input",9),e.YNc(12,it,2,0,"div",10),e.qZA(),e.TgZ(13,"div",7)(14,"label",8),e._uU(15,"Last name*"),e.qZA(),e._UZ(16,"input",11),e.YNc(17,lt,2,1,"div",12),e.qZA()(),e.TgZ(18,"div",6)(19,"div",7)(20,"label",8),e._uU(21,"Email*"),e.qZA(),e._UZ(22,"input",13),e.YNc(23,dt,3,2,"div",12),e.qZA(),e.TgZ(24,"div",7)(25,"label",8),e._uU(26,"Create date"),e.qZA(),e._UZ(27,"input",14),e.qZA()(),e._UZ(28,"hr"),e.TgZ(29,"div",6)(30,"div",15)(31,"label",8),e._uU(32,"Address*"),e.qZA(),e._UZ(33,"input",16),e.YNc(34,ft,2,1,"div",12),e.qZA()(),e.TgZ(35,"div",6)(36,"div",15)(37,"label",8),e._uU(38,"Address 2"),e.qZA(),e._UZ(39,"input",17),e.qZA()(),e.TgZ(40,"div",6)(41,"div",7)(42,"label",8),e._uU(43,"District*"),e.qZA(),e._UZ(44,"input",18),e.YNc(45,pt,2,1,"div",12),e.qZA(),e.TgZ(46,"div",7)(47,"label",8),e._uU(48,"Phone number*"),e.qZA(),e._UZ(49,"input",19,20),e.YNc(51,vt,3,2,"div",12),e.qZA()(),e.TgZ(52,"div",6)(53,"div",7)(54,"label",8),e._uU(55,"Postal code*"),e.qZA(),e._UZ(56,"input",21,22),e.YNc(58,Ct,3,2,"div",12),e.qZA()(),e.TgZ(59,"div",6)(60,"div",7)(61,"label",8),e._uU(62,"Country*"),e.qZA(),e._UZ(63,"select",23,24),e.YNc(65,St,2,0,"div",10),e.qZA(),e.TgZ(66,"div",7)(67,"label",8),e._uU(68,"City*"),e.qZA(),e._UZ(69,"select",25,26),e.YNc(71,Tt,2,0,"div",10),e.qZA()(),e._UZ(72,"hr"),e.TgZ(73,"div",27)(74,"div",28)(75,"button",29),e._uU(76,"Save"),e.qZA()(),e.TgZ(77,"div",28)(78,"button",30),e.NdJ("click",function(){return n.onReset()}),e._uU(79,"Reset"),e.qZA()()()()()()),2&o&&(e.xp6(6),e.Q6J("formGroup",n.fg_customer),e.xp6(6),e.Q6J("ngIf",n.first_name&&n.first_name.invalid&&(n.first_name.dirty||n.first_name.touched)),e.xp6(5),e.Q6J("ngIf",n.last_name&&n.last_name.invalid&&(n.last_name.dirty||n.last_name.touched)),e.xp6(6),e.Q6J("ngIf",n.email&&n.email.invalid&&(n.email.dirty||n.email.touched)),e.xp6(11),e.Q6J("ngIf",n.address&&n.address.invalid&&(n.address.dirty||n.address.touched)),e.xp6(11),e.Q6J("ngIf",n.district&&n.district.invalid&&(n.district.dirty||n.district.touched)),e.xp6(6),e.Q6J("ngIf",n.phone&&n.phone.invalid&&(n.phone.dirty||n.phone.touched)),e.xp6(7),e.Q6J("ngIf",n.postal_code&&n.postal_code.invalid&&(n.postal_code.dirty||n.postal_code.touched)),e.xp6(7),e.Q6J("ngIf",n.country&&n.country.invalid&&(n.country.dirty||n.country.touched)&&(null==n.country.errors?null:n.country.errors.required)),e.xp6(6),e.Q6J("ngIf",n.city&&n.city.invalid&&(n.city.dirty||n.city.touched)&&(null==n.city.errors?null:n.city.errors.required)))},dependencies:[y.O5,l._Y,l.Fj,l.EJ,l.JJ,l.JL,l.sg,l.u]}),t})();const bt=function(){return["/order/customer"]};let R=(()=>{class t{constructor(){}ngOnInit(){}ngAfterViewInit(){return(0,m.Z)(function*(){})()}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-customer"]],decls:10,vars:2,consts:[[1,"d-sm-flex","align-items-center","justify-content-between","mb-4"],[1,"h3","mb-0","text-gray-800"],["type","button",1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-arrow-circle-left"],[1,"row"],[1,"col-lg-6"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1)(2,"a",2),e._UZ(3,"i",3),e.qZA(),e._uU(4,"\xa0\xa0Customer & rentals"),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5),e._UZ(7,"app-customer-info"),e.qZA(),e.TgZ(8,"div",5),e._UZ(9,"app-customer-search-address"),e.qZA()()),2&o&&(e.xp6(2),e.Q6J("routerLink",e.DdM(1,bt)))},dependencies:[h.yS,Le,Zt]}),t})();const It=[{path:"",component:k,children:[{path:"customer",component:ee},{path:"customer/:customer_id",component:R},{path:"customer/create",component:R}]}];let wt=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,h.Bz.forChild(It)]}),t})();var At=c(4805);let Nt=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.ez,h.Bz,wt,l.UX,At.x,Re]}),t})()}}]);